---
layout: default
title: Dream Team
header_title: Nosso Dream Team ðŸš€
---

<section class="container">
  <link rel="stylesheet" href="index.css" />
  <script src="util.js"></script>
  <script type="module">
    import { tribes, squads } from '/culture/dream-team/tribes.js'
    import { devTeam } from '/culture/dream-team/team-dev.js'
    import { productTeam } from '/culture/dream-team/team-product.js'
    import { uxTeam } from '/culture/dream-team/team-ux.js'
    import { dataTeam } from '/culture/dream-team/team-data.js'

    function renderMember(member) {
      const updatedDescription = member.description.replace(
        /getTotalYears\('(\d{2}\/\d{2}\/\d{4})'\)/g,
        (match, birthDateString) => `${getTotalYears(birthDateString)}`,
      )

      const memberId = `member-${member.name.toLowerCase().replace(/\s+/g, '-')}`
      const colDiv = document.createElement('div')
      colDiv.classList.add('col')
      colDiv.id = memberId
      colDiv.innerHTML = `
        <div class="card">
          <div class="content">
            <div class="scroll">
              <p>${updatedDescription}</p>
            </div>
          </div>
          <div class="card-footer">
            <div class="info-section">
              <img class="avatar" src="${member.avatar}" alt="avatar" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(member.name)}&background=444c56&color=d6e0eb&size=128'">
              <div class="author">
                <p class="name">${member.name}</p>
                <span class="role">${member.role}_</span>
              </div>
            </div>
            <div class="social-section">
              <div class="social-links">
                ${
                  member.linkedin
                    ? `<a href="${member.linkedin}" target="_blank" rel="noopener noreferrer">
                        <i class="fab fa-linkedin"></i>
                      </a>`
                    : ''
                }
                ${
                  member.github
                    ? `<a href="${member.github}" target="_blank" rel="noopener noreferrer">
                        <i class="fab fa-github"></i>
                      </a>`
                    : ''
                }
              </div>
              <img class="uol" src="https://i.imgur.com/8OjyFNE.png" alt="uol" />
            </div>
          </div>
        </div>
      `

      return colDiv
    }

    function groupMembersByTribeAndSquad(allMembers) {
      const grouped = {}

      allMembers.forEach((member) => {
        const tribeKeys = member.tribes?.map((key) => key) || []
        const squadKeys = member.squads?.map((key) => key) || []

        tribeKeys.forEach((tribe) => {
          if (!grouped[tribe]) grouped[tribe] = {}

          squadKeys.forEach((squad) => {
            if (!grouped[tribe][squad]) grouped[tribe][squad] = []
            grouped[tribe][squad].push(member)
          })
        })
      })

      return grouped
    }

    function getTribeLeadership(tribeKey, allMembers) {
      const leadership = {
        gpm: null,
        em_sr: null,
        ux_lead: null,
        da: null,
      }

      allMembers.forEach((member) => {
        const isFromTribe = member.tribes?.includes(tribeKey)
        const isLeaderWithoutSquad =
          !member.squads?.length &&
          (member.role?.toLowerCase().includes('group product manager') ||
            member.role?.toLowerCase().includes('engineering manager sr') ||
            member.role?.toLowerCase().includes('ux lead') ||
            member.role?.toLowerCase().includes('data lead'))

        if (!isFromTribe || !isLeaderWithoutSquad) return

        const role = member.role?.toLowerCase() || ''

        if (role.includes('group product manager')) {
          leadership.gpm = member
        } else if (role.includes('engineering manager sr')) {
          leadership.em_sr = member
        } else if (role.includes('ux lead')) {
          leadership.ux_lead = member
        } else if (
          (role.includes('data analytics') ||
            role.includes('data lead') ||
            role.includes('data engineer')) &&
          !leadership.da
        ) {
          leadership.da = member
        }
      })

      return leadership
    }

    function getTribeSquads(tribeKey, squadsData, groupedMembers, leadership) {
      const tribeSquads = []
      const leaderIds = new Set()
      Object.values(leadership).forEach((leader) => {
        if (leader) leaderIds.add(leader.name)
      })

      Object.keys(squadsData).forEach((squadKey) => {
        const squad = squadsData[squadKey]

        if (squad.tribe_key === tribeKey) {
          let members = groupedMembers[tribeKey]?.[squadKey] || []

          members = members.filter((member) => !leaderIds.has(member.name))

          if (members.length > 0) tribeSquads.push({ squad, members, squadKey })
        }
      })

      return tribeSquads
    }

    function groupMembersByRole(members) {
      const roleMapping = {
        pm: ['product manager', 'pm', 'gpm'],
        em: ['engineering manager', 'em'],
        pd: ['ux', 'product designer', 'designer'],
        tl: ['tech lead', 'tl'],
        dev: ['developer', 'dev', 'frontend', 'backend', 'full stack', 'qa'],
      }

      const byRole = {
        PM: [],
        EM: [],
        PD: [],
        TL: [],
        Dev: [],
      }

      members.forEach((member) => {
        const role = (member.role || '').toLowerCase()
        let assigned = false

        Object.keys(roleMapping).forEach((key) => {
          if (!assigned && roleMapping[key].some((r) => role.includes(r))) {
            const roleKey = key.toUpperCase()
            if (roleKey === 'PM') byRole['PM'].push(member)
            else if (roleKey === 'EM') byRole['EM'].push(member)
            else if (roleKey === 'PD') byRole['PD'].push(member)
            else if (roleKey === 'TL') byRole['TL'].push(member)
            else if (roleKey === 'DEV') byRole['Dev'].push(member)
            assigned = true
          }
        })

        if (!assigned) byRole['Dev'].push(member)
      })

      return byRole
    }

    function renderPersonNode(member, isLeader) {
      const nodeClass = isLeader ? 'person-node leader-node' : 'person-node member-node'
      const iconClass = isLeader ? 'person-icon leader-icon' : 'person-icon member-icon'
      const memberId = `member-${member.name.toLowerCase().replace(/\s+/g, '-')}`

      return `
        <div class="${nodeClass}" title="${member.name} - ${member.role}" onclick="scrollToMember('${memberId}')">
          <svg class="${iconClass}" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="35" r="18" fill="currentColor" opacity="0.9"/>
            <ellipse cx="50" cy="75" rx="30" ry="25" fill="currentColor" opacity="0.9"/>
          </svg>
          <div class="person-name-small">${member.name.split(' ')[0]}</div>
        </div>
      `
    }

    function renderPersonNodeWithDetails(member, isLeader, showFullRole = true) {
      const nodeClass = isLeader
        ? 'person-node-detail leader-node'
        : 'person-node-detail member-node'
      const memberId = `member-${member.name.toLowerCase().replace(/\s+/g, '-')}`
      const avatarUrl =
        member.avatar && member.avatar.trim() !== ''
          ? member.avatar
          : `https://ui-avatars.com/api/?name=${encodeURIComponent(member.name)}&background=444c56&color=d6e0eb&size=128`

      return `
        <div class="${nodeClass}" onclick="scrollToMember('${memberId}')">
          <img class="person-avatar" src="${avatarUrl}" alt="${member.name}" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(member.name)}&background=444c56&color=d6e0eb&size=128'" />
          <div class="person-details">
            <div class="person-name-detail">${member.name}</div>
            <div class="person-role-detail">${showFullRole ? member.role : member.role.split(' ')[0].split('')[0] + member.role.split(' ')[1].split('')[0]}</div>
          </div>
        </div>
      `
    }

    function renderPrincipalEngineersSection(peMembers) {
      const peSection = document.createElement('div')
      peSection.classList.add('principal-engineers-section')
      peSection.innerHTML = `
        <div class="pe-container">
          <div class="pe-label">SHARED</div>
          <div class="pe-content">
            <div class="pe-title">Principal Engineers</div>
            <div class="pe-members">
              ${peMembers.map((member) => renderPersonNodeWithDetails(member, false, true)).join('')}
            </div>
          </div>
        </div>
      `
      return peSection
    }

    function renderSquadMemberListItem(member) {
      const memberId = `member-${member.name.toLowerCase().replace(/\s+/g, '-')}`
      const avatarUrl =
        member.avatar && member.avatar.trim() !== ''
          ? member.avatar
          : `https://ui-avatars.com/api/?name=${encodeURIComponent(member.name)}&background=444c56&color=d6e0eb&size=128`

      return `
        <div class="squad-member-list-item" onclick="scrollToMember('${memberId}')">
          <img class="squad-member-avatar" src="${avatarUrl}" alt="${member.name}" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(member.name)}&background=444c56&color=d6e0eb&size=128'" />
          <div class="squad-member-info">
            <p class="squad-member-name">${member.name}</p>
            <span class="squad-member-role">${member.role}</span>
          </div>
        </div>
      `
    }

    function renderSquadCard(squad, members) {
      const squadMembersByRole = groupMembersByRole(members)

      const topMembers = [
        ...(squadMembersByRole['PM'] || []),
        ...(squadMembersByRole['PD'] || []),
        ...(squadMembersByRole['EM'] || []),
      ]

      const devMembers = [...(squadMembersByRole['TL'] || []), ...(squadMembersByRole['Dev'] || [])]

      return `
        <div class="squad-card">
          <div class="squad-label">SQUAD</div>
          <div class="squad-header">
            <h4 class="squad-name">${squad.name}</h4>
            <div class="squad-outcome-badge">${squad.description}</div>
          </div>
          <div class="squad-members-visual">
            ${
              topMembers.length > 0
                ? `
              <div class="squad-members-top">
                ${topMembers.map((member) => renderPersonNodeWithDetails(member, false, false)).join('')}
              </div>
            `
                : ''
            }
            ${
              devMembers.length > 0
                ? `
              ${topMembers.length > 0 ? '<div class="squad-divider"></div>' : ''}
              <div class="squad-members-list">
                ${devMembers.map((member) => renderSquadMemberListItem(member)).join('')}
              </div>
            `
                : ''
            }
          </div>
        </div>
      `
    }

    function renderSquadsLevel(tribeSquads) {
      return `
        <div class="organogram-level squads-level">
          ${tribeSquads.map(({ squad, members, squadKey }) => renderSquadCard(squad, members)).join('')}
        </div>
      `
    }

    function renderTribeLevel(tribeKey, tribeData, leadership, tribeSquads, allMembers) {
      const tribeLeaders = [
        leadership.gpm,
        leadership.em_sr,
        leadership.ux_lead,
        leadership.da,
      ].filter(Boolean)

      return `
        <div class="organogram-level tribe-level">
          <div class="tribe-container-visual">
            <div class="tribe-label">TRIBO</div>
            <div class="tribe-content-wrapper">
              <div class="tribe-content">
                <div class="tribe-name-large">${tribeData.name}</div>
                ${tribeData.description ? `<p class="tribe-description-inline">${tribeData.description}</p>` : ''}
                <div class="tribe-members-horizontal">
                  ${tribeLeaders.map((member) => renderPersonNodeWithDetails(member, false, true)).join('')}
                </div>
              </div>
            </div>
          </div>
          ${renderSquadsLevel(tribeSquads)}
        </div>
      `
    }

    function renderTribeLeadershipVisual(leadership) {
      const leaders = [
        { role: 'GPM', member: leadership.gpm },
        { role: 'EM Sr', member: leadership.em_sr },
        { role: 'UX Lead', member: leadership.ux_lead },
        { role: 'DA', member: leadership.da },
      ]

      return `
        <div class="tribe-leaders">
          ${leaders
            .map((leader) => {
              return `
              <div class="leader-item">
                <div class="leader-role">${leader.role}</div>
                <div class="leader-name">${leader.member.name}</div>
              </div>
            `
            })
            .join('')}
        </div>
      `
    }

    function renderOrganogram(tribeKey, tribeData, groupedMembers, squadsData, allMembers) {
      const leadership = getTribeLeadership(tribeKey, allMembers)
      const tribeSquads = getTribeSquads(tribeKey, squadsData, groupedMembers, leadership)

      return `
        <div class="organogram-container">
          ${renderTribeLevel(tribeKey, tribeData, leadership, tribeSquads, allMembers)}
        </div>
      `
    }

    function renderTribe(tribeKey, tribeData, groupedMembers, squadsData, allMembers) {
      const tribeContainer = document.createElement('div')
      tribeContainer.classList.add('tribe-container')

      const organogramWrapper = document.createElement('div')
      organogramWrapper.classList.add('tribe-organogram-wrapper')
      const organogramHtml = renderOrganogram(
        tribeKey,
        tribeData,
        groupedMembers,
        squadsData,
        allMembers,
      )
      organogramWrapper.innerHTML = organogramHtml
      tribeContainer.appendChild(organogramWrapper)

      return tribeContainer
    }

    function renderAllTribes() {
      const container = document.getElementById('workforceContainer')

      const introText = document.createElement('div')
      introText.classList.add('workforce-intro')
      introText.innerHTML = '<p class="workforce-intro-text">Estrutura Prod&Tech de Workforce</p>'
      container.appendChild(introText)

      const allMembers = [...devTeam, ...productTeam, ...uxTeam, ...dataTeam]
      
      // Filtrar PEs (Principal Engineers) que sÃ£o shared entre tribos
      const principalEngineers = allMembers.filter(
        (member) =>
          member.role?.toLowerCase().includes('principal engineer') &&
          (!member.tribes || (Array.isArray(member.tribes) && member.tribes.length === 0))
      )

      // Renderizar seÃ§Ã£o de PEs se houver
      if (principalEngineers.length > 0) {
        const peSection = renderPrincipalEngineersSection(principalEngineers)
        container.appendChild(peSection)
      }

      const grouped = groupMembersByTribeAndSquad(allMembers)

      Object.values(tribes).forEach((tribe) => {
        const tribeElement = renderTribe(tribe.key, tribe, grouped, squads, allMembers)
        container.appendChild(tribeElement)
      })

      const cardsSectionTitle = document.createElement('div')
      cardsSectionTitle.classList.add('col-wide')
      cardsSectionTitle.style.marginTop = '3em'
      cardsSectionTitle.innerHTML = '<h2 class="cards-section-title">Pessoas_</h2>'
      container.appendChild(cardsSectionTitle)

      const allCardsRow = document.createElement('div')
      allCardsRow.classList.add('row', 'all-members-cards')
      allMembers.forEach((member) => {
        allCardsRow.appendChild(renderMember(member))
      })
      container.appendChild(allCardsRow)
    }

    function scrollToMember(memberId) {
      const memberCard = document.getElementById(memberId)
      if (memberCard) {
        document.querySelectorAll('.card.highlighted').forEach((card) => {
          card.classList.remove('highlighted')
        })

        const card = memberCard.querySelector('.card')
        if (card) card.classList.add('highlighted')

        memberCard.scrollIntoView({ behavior: 'smooth', block: 'center' })

        setTimeout(() => {
          if (card) card.classList.remove('highlighted')
        }, 3000)
      }
    }

    window.scrollToMember = scrollToMember

    function renderMembersByRole(membersByRole) {
      const roleOrder = ['PM', 'EM', 'PD', 'TL', 'Dev']
      let html = ''

      roleOrder.forEach((role) => {
        const members = membersByRole[role]
        if (members.length > 0) {
          html += `
            <div class="role-group">
              <span class="role-label">${role}</span>
              <span class="members-list">${members.map((m) => m.name).join(', ')}</span>
            </div>
          `
        }
      })

      return html
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', renderAllTribes)
    } else {
      renderAllTribes()
    }

    window.renderAllTribes = renderAllTribes
  </script>

  <div id="workforceContainer">
     <!-- Tribes and squads will be rendered here via JavaScript -->
  </div>
</section>
